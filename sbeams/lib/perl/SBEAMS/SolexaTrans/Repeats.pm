package SBEAMS::SolexaTrans::Repeats;
use base qw(Class::AutoClass);
use strict;
use warnings;
use Carp;
use Data::Dumper;

use vars qw(@AUTO_ATTRIBUTES @CLASS_ATTRIBUTES %DEFAULTS %SYNONYMS);
@AUTO_ATTRIBUTES = qw(repeats repeat_length);
@CLASS_ATTRIBUTES = qw();
%DEFAULTS = (repeat_length=>16);
%SYNONYMS = ();

Class::AutoClass::declare(__PACKAGE__);


my %repeats=(
  atacatacatacatac=>'0',
  tatgtatgtatgtatg=>'0',
  cccacccacccaccca=>'0',
  acgtacgtacgtacgt=>'0',
  tcaatcaatcaatcaa=>'0',
  gcccgcccgcccgccc=>'0',
  cggacggacggacgga=>'0',
  ccggccggccggccgg=>'0',
  tctatctatctatcta=>'0',
  cctccctccctccctc=>'0',
  tgcttgcttgcttgct=>'0',
  gtctgtctgtctgtct=>'0',
  catgcatgcatgcatg=>'0',
  gtgagtgagtgagtga=>'0',
  tggttggttggttggt=>'0',
  tctctctctctctctc=>'0',
  ttacttacttacttac=>'0',
  ggacggacggacggac=>'0',
  gggggggggggggggg=>'0',
  cagtcagtcagtcagt=>'0',
  cgttcgttcgttcgtt=>'0',
  atgcatgcatgcatgc=>'0',
  agtgagtgagtgagtg=>'0',
  tgcgtgcgtgcgtgcg=>'0',
  agccagccagccagcc=>'0',
  tttttttttttttttt=>'0',
  aaaaaaaaaaaaaaaa=>'0',
  gagtgagtgagtgagt=>'0',
  ctcgctcgctcgctcg=>'0',
  ttggttggttggttgg=>'0',
  tacgtacgtacgtacg=>'0',
  agtcagtcagtcagtc=>'0',
  aggtaggtaggtaggt=>'0',
  gaaggaaggaaggaag=>'0',
  attaattaattaatta=>'0',
  tgtttgtttgtttgtt=>'0',
  aaggaaggaaggaagg=>'0',
  cagccagccagccagc=>'0',
  cttacttacttactta=>'0',
  cagacagacagacaga=>'0',
  gcgcgcgcgcgcgcgc=>'0',
  tgcatgcatgcatgca=>'0',
  gtttgtttgtttgttt=>'0',
  cgtacgtacgtacgta=>'0',
  cccgcccgcccgcccg=>'0',
  ggcaggcaggcaggca=>'0',
  accaaccaaccaacca=>'0',
  ggctggctggctggct=>'0',
  ctatctatctatctat=>'0',
  tgattgattgattgat=>'0',
  ccgtccgtccgtccgt=>'0',
  ccagccagccagccag=>'0',
  caggcaggcaggcagg=>'0',
  cttccttccttccttc=>'0',
  actgactgactgactg=>'0',
  atttatttatttattt=>'0',
  gcatgcatgcatgcat=>'0',
  tatctatctatctatc=>'0',
  ggttggttggttggtt=>'0',
  ttaattaattaattaa=>'0',
  ctgactgactgactga=>'0',
  ttctttctttctttct=>'0',
  cccccccccccccccc=>'0',
  cactcactcactcact=>'0',
  acctacctacctacct=>'0',
  tctgtctgtctgtctg=>'0',
  gtcagtcagtcagtca=>'0',
  acacacacacacacac=>'0',
  aagaaagaaagaaaga=>'0',
  atagatagatagatag=>'0',
  gttagttagttagtta=>'0',
  gcttgcttgcttgctt=>'0',
  aggcaggcaggcaggc=>'0',
  acaaacaaacaaacaa=>'0',
  gaatgaatgaatgaat=>'0',
  tctttctttctttctt=>'0',
  tatatatatatatata=>'0',
  tcgttcgttcgttcgt=>'0',
  tcgctcgctcgctcgc=>'0',
  taattaattaattaat=>'0',
  ccatccatccatccat=>'0',
  cacacacacacacaca=>'0',
  aagtaagtaagtaagt=>'0',
  aacaaacaaacaaaca=>'0',
  atggatggatggatgg=>'0',
  gctggctggctggctg=>'0',
  tgcctgcctgcctgcc=>'0',
  tagatagatagataga=>'0',
  gttcgttcgttcgttc=>'0',
  gcgggcgggcgggcgg=>'0',
  ttccttccttccttcc=>'0',
  agctagctagctagct=>'0',
  attcattcattcattc=>'0',
  tccgtccgtccgtccg=>'0',
  gctagctagctagcta=>'0',
  cgtccgtccgtccgtc=>'0',
  agacagacagacagac=>'0',
  atcgatcgatcgatcg=>'0',
  ttgcttgcttgcttgc=>'0',
  gcacgcacgcacgcac=>'0',
  aatgaatgaatgaatg=>'0',
  cggtcggtcggtcggt=>'0',
  tggctggctggctggc=>'0',
  acgcacgcacgcacgc=>'0',
  gagagagagagagaga=>'0',
  gtgtgtgtgtgtgtgt=>'0',
  ttcgttcgttcgttcg=>'0',
  tgagtgagtgagtgag=>'0',
  tggatggatggatgga=>'0',
  gcaagcaagcaagcaa=>'0',
  gagggagggagggagg=>'0',
  tcggtcggtcggtcgg=>'0',
  tcattcattcattcat=>'0',
  gtacgtacgtacgtac=>'0',
  cttgcttgcttgcttg=>'0',
  ttgattgattgattga=>'0',
  ctttctttctttcttt=>'0',
  gggtgggtgggtgggt=>'0',
  cctacctacctaccta=>'0',
  gtccgtccgtccgtcc=>'0',
  ggaaggaaggaaggaa=>'0',
  ctaactaactaactaa=>'0',
  ctccctccctccctcc=>'0',
  cgggcgggcgggcggg=>'0',
  cgcgcgcgcgcgcgcg=>'0',
  tgactgactgactgac=>'0',
  aataaataaataaata=>'0',
  ggtcggtcggtcggtc=>'0',
  ccttccttccttcctt=>'0',
  gcaggcaggcaggcag=>'0',
  agcaagcaagcaagca=>'0',
  ggccggccggccggcc=>'0',
  cgaacgaacgaacgaa=>'0',
  cacccacccacccacc=>'0',
  tccttccttccttcct=>'0',
  tagctagctagctagc=>'0',
  aattaattaattaatt=>'0',
  ctagctagctagctag=>'0',
  ttcattcattcattca=>'0',
  taaataaataaataaa=>'0',
  aatcaatcaatcaatc=>'0',
  tcactcactcactcac=>'0',
  ggcgggcgggcgggcg=>'0',
  aaataaataaataaat=>'0',
  cgctcgctcgctcgct=>'0',
  caaccaaccaaccaac=>'0',
  catacatacatacata=>'0',
  cgtgcgtgcgtgcgtg=>'0',
  gggagggagggaggga=>'0',
  aagcaagcaagcaagc=>'0',
  cgcccgcccgcccgcc=>'0',
  gggcgggcgggcgggc=>'0',
  agggagggagggaggg=>'0',
  caatcaatcaatcaat=>'0',
  taggtaggtaggtagg=>'0',
  tgtgtgtgtgtgtgtg=>'0',
  ccgcccgcccgcccgc=>'0',
  gtatgtatgtatgtat=>'0',
  tagttagttagttagt=>'0',
  tgaatgaatgaatgaa=>'0',
  acttacttacttactt=>'0',
  gtaagtaagtaagtaa=>'0',
  atatatatatatatat=>'0',
  ccacccacccacccac=>'0',
  tttctttctttctttc=>'0',
  acggacggacggacgg=>'0',
  gcgtgcgtgcgtgcgt=>'0',
  atgtatgtatgtatgt=>'0',
  ttagttagttagttag=>'0',
  tgggtgggtgggtggg=>'0',
  gtaggtaggtaggtag=>'0',
  tacatacatacataca=>'0',
  atctatctatctatct=>'0',
  aaagaaagaaagaaag=>'0',
  gatcgatcgatcgatc=>'0',
  caaacaaacaaacaaa=>'0',
  tccatccatccatcca=>'0',
  cattcattcattcatt=>'0',
  ccctccctccctccct=>'0',
  ttgtttgtttgtttgt=>'0',
  gaacgaacgaacgaac=>'0',
  agaaagaaagaaagaa=>'0',
  tgtctgtctgtctgtc=>'0',
  tccctccctccctccc=>'0',
  ctcactcactcactca=>'0',
  gactgactgactgact=>'0',
  acgaacgaacgaacga=>'0',
  gcctgcctgcctgcct=>'0',
  catccatccatccatc=>'0',
  aggaaggaaggaagga=>'0',
  gacagacagacagaca=>'0',
  gctcgctcgctcgctc=>'0',
  ccgaccgaccgaccga=>'0',
  gttggttggttggttg=>'0',
  gtgcgtgcgtgcgtgc=>'0',
  ctacctacctacctac=>'0',
  ccaaccaaccaaccaa=>'0',
  ggtgggtgggtgggtg=>'0',
  acatacatacatacat=>'0',
  attgattgattgattg=>'0',
  agagagagagagagag=>'0',
  cggccggccggccggc=>'0',
  actcactcactcactc=>'0',
  ctctctctctctctct=>'0',
  tatttatttatttatt=>'0',
  atgaatgaatgaatga=>'0',
  tacctacctacctacc=>'0',
  cgatcgatcgatcgat=>'0',
  gaaagaaagaaagaaa=>'0',
  gccagccagccagcca=>'0',
  ctgcctgcctgcctgc=>'0',
  agtaagtaagtaagta=>'0',
  gtcggtcggtcggtcg=>'0',
  gatagatagatagata=>'0',
  tttatttatttattta=>'0',
  atccatccatccatcc=>'0',
  gacggacggacggacg=>'0',
  gcgagcgagcgagcga=>'0',
  atcaatcaatcaatca=>'0',
  aactaactaactaact=>'0',
  tacttacttacttact=>'0',
  ataaataaataaataa=>'0',
  ttatttatttatttat=>'0',
  aaacaaacaaacaaac=>'0',
  gaccgaccgaccgacc=>'0',
  agatagatagatagat=>'0',
  cacgcacgcacgcacg=>'0',
  gagcgagcgagcgagc=>'0',
  cgaccgaccgaccgac=>'0',
  tcgatcgatcgatcga=>'0',
  taagtaagtaagtaag=>'0',
  ggatggatggatggat=>'0',
  caagcaagcaagcaag=>'0',
  ggagggagggagggag=>'0',
  agcgagcgagcgagcg=>'0',
  actaactaactaacta=>'0',
  cgagcgagcgagcgag=>'0',
  ctggctggctggctgg=>'0',
  ctgtctgtctgtctgt=>'0',
  agttagttagttagtt=>'0',
  taactaactaactaac=>'0',
  gtgggtgggtgggtgg=>'0',
  aaccaaccaaccaacc=>'0',
  acccacccacccaccc=>'0',
  tgtatgtatgtatgta=>'0',
  accgaccgaccgaccg=>'0',
  cctgcctgcctgcctg=>'0',
  gccggccggccggccg=>'0',
  aacgaacgaacgaacg=>'0',
  ggtaggtaggtaggta=>'0',
  gatggatggatggatg=>'0',
  tttgtttgtttgtttg=>'0',
  tcagtcagtcagtcag=>'0',
  gattgattgattgatt=>'0',
  acagacagacagacag=>'0',
  cgcacgcacgcacgca=>'0',
);

sub _init_self {
    my ($self, $class, $args) = @_;
    return unless $class eq __PACKAGE__; # to prevent subclasses from re-running this
    $self->repeats(\%repeats);
}

sub is_repeat {
    my ($self,$tag)=@_;
    defined $self->repeats->{substr($tag,0,$self->repeat_length)};
}

sub tally_repeat { 
    my ($self,$tag)=@_;
    $self->repeats->{substr($tag,0,$self->repeat_length)}++;
}

sub clear {
    my ($self)=0;
    foreach my $r (keys %repeats) { $repeats{$r}=0; }
}
1;
